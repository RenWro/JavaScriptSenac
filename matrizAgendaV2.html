<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trabalhando Matrizes Agenda 2</title>
</head>
<body>
<script>
    let dados = ["nome", "data de nascimento", "whatsApp", "email"];
    let agenda = [];
    let i = 0; // Controla a linha da matriz
    let resp; // Declarando 'resp' aqui para garantir que está acessível posteriormente no loop

    do {
        let entradaValida; // Usado para verificar a validade da entrada
        let nome = prompt("Digite " + dados[0]);
        let dataNascimento = prompt("Digite " + dados[1] + " no formato dd/MM/aaaa");

        let whatsApp;
        // Loop para validação de entrada do WhatsApp apenas com números
        do {
            whatsApp = prompt("Digite " + dados[2] + " (somente números)");
            entradaValida = /^\d+$/.test(whatsApp);
            if (!entradaValida) { // Se a entrada não for válida, mostra mensagem de erro
                alert("Erro. Por favor, insira um dado válido.");
            }
        } while (!entradaValida); // Verifica se é composto apenas por números
        /*
        A expressão ^\d+$ é uma expressão regular (regex) usada para validar strings de texto, garantindo que elas contenham apenas dígitos numéricos. Vamos quebrar a expressão para entender melhor cada parte:

        1 - ^ - Este é o caractere de ancoragem que corresponde ao início da string. Ele garante que a correspondência comece a partir do primeiro caractere da string.
        2 - \d - Esta é uma classe de caracteres especiais em regex que corresponde a qualquer dígito numérico (0-9). É equivalente a [0-9].
        3 - + - Este quantificador corresponde a uma ou mais ocorrências do caractere ou padrão imediatamente anterior a ele. Neste caso, ele se aplica ao \d, significando que a string deve ter um ou mais dígitos.
        4 - $ - Este é o caractere de ancoragem que corresponde ao final da string. Ele assegura que a correspondência termine no último caractere da string.

         .test = O método .test() é um método em JavaScript aplicável a objetos de expressão regular (regex). Ele é usado para testar a presença de um padrão em uma string. Se a string testada corresponder ao padrão da expressão regular, .test() retorna true; caso contrário, retorna false.
         */

        let email;
        // Loop para validação de entrada do e-mail contendo '@'
        do {
            email = prompt("Digite " + dados[3] + " (deve conter '@')");
            entradaValida = email.includes('@');
            if (!entradaValida) { // Se a entrada não for válida, mostra mensagem de erro
                alert("Erro. Por favor, insira um dado válido.");
            }
        } while (!entradaValida); // Repete até que uma entrada válida seja fornecida

        // Armazenando os dados na matriz agenda
        agenda[i] = [nome, dataNascimento, whatsApp, email];
        i++; // Incrementa para a próxima linha

        // Loop para validação da resposta sobre cadastrar outra pessoa
        do {
            resp = prompt("Cadastrar outra pessoa: \n(1) - sim.\n(2) - não.").toLowerCase();
            if (!["1", "sim", "2", "não"].includes(resp)) { // Aceita variações de sim e não
                alert("Erro. Por favor, insira um dado válido.");
            } else {
                // Sair do loop de validação se a resposta for válida
                break;
            }
        } while (true);
        // Continuar enquanto a resposta for "1" ou "sim"
    } while (resp === "1" || resp === "sim");

    console.log(agenda);

    // Exibe os dados coletados na página
    for (let l = 0; l < agenda.length; l++) {
        document.write(
            agenda[l][0] + " | " +
            agenda[l][1] + " | " +
            agenda[l][2] + " | " +
            agenda[l][3] + " | <br>"
        );
    }
</script>
</body>
</html>
